@startuml
!theme plain

skinparam packageStyle rectangle
skinparam package {
  BackgroundColor White
  BorderColor Black
  BorderThickness 2
  FontSize 11
}

skinparam arrow {
  Color Black
  Thickness 1
}

package "bookstore" <<Package>> {
  
  package "catalog" <<Package>> {
    package "books" <<Package>> as books
    package "authors" <<Package>> as authors
    package "publishers" <<Package>> as publishers
    package "categories" <<Package>> as categories
    package "reviews" <<Package>> as reviews
  }
  
  package "ordering" <<Package>> {
    package "cart" <<Package>> as cart
    package "orders" <<Package>> as orders
    package "payments" <<Package>> as payments
    package "shipping" <<Package>> as shipping
  }
  
  package "customer" <<Package>> {
    package "accounts" <<Package>> as accounts
    package "profiles" <<Package>> as profiles
    package "wishlists" <<Package>> as wishlists
    package "purchase-history" <<Package>> as purchase_history
  }
  
  package "inventory" <<Package>> {
    package "warehouses" <<Package>> as warehouses
    package "stock" <<Package>> as stock
    package "suppliers" <<Package>> as suppliers
  }
  
  package "marketing" <<Package>> {
    package "campaigns" <<Package>> as campaigns
    package "coupons" <<Package>> as coupons
    package "recommendations" <<Package>> as recommendations
  }
  
  package "admin" <<Package>> {
    package "reports" <<Package>> as reports
    package "analytics" <<Package>> as analytics
  }
  
  package "common" <<Package>> {
    package "auth" <<Package>> as auth
    package "notifications" <<Package>> as notifications
    package "search" <<Package>> as search
    package "logging" <<Package>> as logging
    package "config" <<Package>> as config
  }
}

' カタログの依存関係
books ..> authors : 著者
books ..> publishers : 出版社
books ..> categories : カテゴリー
reviews ..> books : 評価する
reviews ..> accounts : 投稿者

' 注文の依存関係
cart ..> books : 商品追加
cart ..> accounts : 所有者
orders ..> cart : チェックアウト
orders ..> payments : 決済処理
orders ..> shipping : 配送手配
orders ..> coupons : クーポン適用
shipping ..> warehouses : 出荷元

' 顧客の依存関係
profiles ..> accounts : プロフィール
wishlists ..> books : お気に入り
wishlists ..> accounts : 所有者
purchase_history ..> orders : 購入履歴

' 在庫の依存関係
stock ..> books : 在庫管理
stock ..> warehouses : 保管場所
warehouses ..> suppliers : 仕入先

' マーケティングの依存関係
campaigns ..> books : 宣伝する
coupons ..> orders : 割引適用
recommendations ..> books : 推薦する
recommendations ..> purchase_history : 分析する

' 管理の依存関係
reports ..> orders : レポート生成
reports ..> stock : 在庫集計
analytics ..> purchase_history : 分析する

' 共通機能の依存関係
auth ..> accounts : 認証する
notifications ..> orders : 通知する
notifications ..> shipping : 状況更新
search ..> books : 検索する
logging ..> config : 設定読込

@enduml
